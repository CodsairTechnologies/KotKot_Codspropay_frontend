<div class="background">
    <div class="row  first-row">
        <!-- breadcrumbs -->
        <div class="col">
            <div class="breadcrumb">
                <!-- <span class="home-icon"><i class="bi bi-house-door-fill"></i></span> -->
                <a href="/reception/Dashboard" class="breadcrumb-item">Dashboard</a>
            </div>
        </div>
        <!-- breadcrumbs -->
    </div>


    <div class="row w-100 ">

        <div class="col-8">
            <div class="row ml-2" *ngFor="let item of countsArray">

                <div class="col">
                    <div class="card first-card p-2">
                        <div class="header-card ">
                            <div class="col-2 justify-content-center d-flex">
                                <div class="user-icon"><i class="bi bi-person-video2"></i></div>
                            </div>
                            <div class="col-8 justify-content-center d-flex">
                                <div class="user-name">No.of Employees </div>
                            </div>
                            <!-- <div class="col-2 justify-content-center d-flex">
                                <div class="options"><i class="bi bi-three-dots-vertical"></i></div>
                            </div> -->
                        </div>
                        <div class="footer-card justify-content-center d-flex mt-2">
                            <p class="count">{{item.employeecount}}</p>
                        </div>
                    </div>
                </div>

                <div class="col ">
                    <div class="card second-card">
                        <div class="header-card2 p-2">
                            <div class="col-2 justify-content-center d-flex">
                                <div class="user-icon"><i class="bi bi-graph-down"></i></div>
                            </div>
                            <div class="col-8 justify-content-center d-flex">
                                <div class="user-name">No. of Units </div>
                            </div>
                            <!-- <div class="col-2 justify-content-center d-flex">
                                <div class="options"><i class="bi bi-three-dots-vertical"></i></div>
                            </div> -->
                        </div>
                        <div class="footer-card justify-content-center d-flex mt-2">
                            <p class="count">{{item.unitcount}}</p>
                        </div>
                    </div>
                </div>

            </div>

            <div class="row mb-3">
                <div class="calender calendar-container mt-3">
                    <full-calendar [options]="calendarOptions"></full-calendar>
                </div>
            </div>
        </div>

        <div class="col-4">
            <div class="row mr-3">


                <div class="card todo-card">
                    <div class="header">
                        <h3 class="employee-heading">Todo :</h3>
                        <button class="add-icon" (click)="toggleForm()">
                            <i class="bi bi-plus-circle-fill"></i>
                        </button>
                    </div>

                    <form [formGroup]="todoForm" (ngSubmit)="addTodo()">
                        <div *ngIf="isFormVisible" class="row todo-form p-2">
                            <div class="col-12 mb-2">
                                <input formControlName="newTodo" placeholder="New To-Do" class="form-control">
                            </div>
                            <div class="col-12 mb-2">
                                <button type="submit" class="btn btn-primary w-100">Add</button>
                            </div>
                        </div>
                    </form>



                    <table class="todo-table">
                        <!-- <thead>
                          <tr>
                            <th>Select</th>
                            <th>Task</th>
                            <th>Date</th>
                          </tr>
                        </thead> -->
                        <tbody>
                            <tr *ngFor="let item of toDoList; index as i" class="table-row">
                                <!-- <td>
                                <input type="checkbox" [checked]="item.isChecked" (change)="toggleCheckbox(i)">
                              </td> -->
                                <td>{{ item.todo }}</td>
                                <td class="text-right">

                                    <i class="bi bi-eye-fill me-3" (click)="getToDoById(item.id)" data-bs-toggle="modal"
                                        data-bs-target="#edittodomodal"></i>
                                    <i class="bi bi-trash" (click)="openDeleteModal(item.id)" data-bs-toggle="modal"
                                        data-bs-target="#confirmDeleteModal"></i>

                                    <!-- <i class="bi bi-chevron-right tododetails" (click)="getToDoById(item.id)" data-bs-toggle="modal" data-bs-target="#todoModal"></i> -->
                                </td>
                            </tr>
                        </tbody>

                    </table>



                </div>



            </div>

            <div class="row  mr-3 mt-3">
                <div class="card todo-card">
                    <div class="header">
                        <h3 class="employee-heading">Invoices </h3>
                        <!-- <button class="add-icon" (click)="toggleForm()">
                            <i class="bi bi-plus-circle-fill"></i>
                        </button> -->
                    </div>


                    <div class="table-responsive">
                        <table class="table premium-table mt-3">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <!-- <th>Vendor Name</th> -->
                                    <th>Invoice No</th>
                                    <th>Status</th>
                                    <th>View</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let invoice of invoices">
                                    <td>{{ getFormattedDate(invoice.createddate) }}</td>
                                    <td>{{ invoice.number }}</td>
                                    <td [ngClass]="getStatusClass(invoice.status)">
                                        {{ invoice.status }}
                                    </td>
                                    <td class="text-center">
                                        <a (click)="openInvoice(invoice.image)" class="download-btn">
                                            <i class="bi bi-eye-fill"></i>
                                        </a>
                                    </td>
                                </tr>
                            </tbody>

                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>




    <div class="row w-100 p-4">
        <div class="col-12">
            <div class="card table-card">
                <div class="row p-3 mt-3">
                    <div class="col-9 ">
                        <h3 class="table-heading"> Loan Details</h3>
                    </div>
                    <div class="col-3">
                        <a routerLink="/super-admin/loan-view">
                            <button class="btn table-btn">View all</button>
                        </a>
                    </div>
                </div>


                <div class="row p-3 table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr class="table-row ">
                                <th scope="col">Sl No</th>
                                <!-- <th scope="col">Loan Number</th> -->
                                <th scope="col">Emp ID</th>
                                <th scope="col">Name</th>
                                <th scope="col">Date</th>
                                <th scope="col">Loan Amount</th>
                                <th scope="col">EMI Amount</th>
                                <th scope="col">Balance No.of EMI</th>
                                <th scope="col">Paid Amount</th>
                                <th scope="col">Balance Amount</th>
                                <th scope="col">Close Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-row2" *ngFor="let data of LoanList ; let i= index">
                                <th scope="row">{{ i+ 1 }}</th>
                                <!-- <td>{{ data.loanNo }}</td> -->
                                <td>{{ data.employeeid }}</td>
                                <td>{{ data.name }}</td>
                                <td>{{ data.date }}</td>
                                <td>{{ data.amount }}</td>
                                <td>{{ data.emiamount }}</td>
                                <td>{{ data.remainingemi }}</td>
                                <td>{{ data.paidamount }}</td>
                                <td>{{ data.balanceamount }}</td>
                                <td>{{ data.closuredate }}</td>

                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <br><br><br>
</div>





<!-- Confirmation Modal -->

<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmDeleteModalLabel">Confirm Deletion</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this item?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger-custom" (click)="dltTodoFn()">Delete</button>
            </div>
        </div>
    </div>
</div>

<!-- edit to to -->


<div class="modal fade" id="edittodomodal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true"
    (hidden.bs.modal)="onModalHidden()">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmDeleteModalLabel">To-Do</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form [formGroup]="edittodoForm">
                    <div class="row align-items-center">
                        <div class="col-11">
                            <div class="mb-3 email">
                                <!-- <label for="Todo" class="form-label">Todo</label> -->
                                <textarea class="form-control" id="Todo" placeholder="Enter Todo"
                                    formControlName="newTodo" [readonly]="isReadonly" rows="3"></textarea>
                            </div>

                            <div class="error-msg2"
                                *ngIf="edittodoForm.get('newTodo')?.errors && edittodoForm.get('newTodo')?.touched">
                                <p>Todo is required!</p>
                            </div>
                        </div>

                        <div class="col-1">
                            <div class="edit-todo">
                                <i class="bi bi-pencil-fill fs-5" *ngIf="isReadonly" (click)="enableEdit()"></i>

                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn bttn" (click)="editTodoFn()"
                    [hidden]="!showUpdateButton">Update</button>
            </div>
        </div>
    </div>
</div>




<!-- Calender Events -->

<p-dialog header="Event Details" [(visible)]="displayEventDialog" [modal]="true" [style]="{width: '300px'}">
    <p>Event Date: {{ eventDetail?.date }}</p>

    <form [formGroup]="editeventForm">
        <div class="p-field">
            <label for="eventTitle">Event Title</label>
            <textarea id="eventTitle" formControlName="title" [readonly]="!isEditing" pInputTextarea
                rows="2"></textarea>
        </div>

        <button type="button" (click)="editEvent()" *ngIf="!isEditing" pButton label="Edit"
            class="p-button-primary"></button>
        <button type="button" (click)="saveEvent()" *ngIf="isEditing" pButton label="Save"
            class="p-button-success"></button>
        <button type="button" (click)="deleteEvent()" pButton label="Delete" class="p-button-danger"></button>
        <button type="button" (click)="closeEventDialog()" pButton label="Close" class="p-button-secondary"></button>
    </form>
</p-dialog>


<p-dialog header="Add Event" [(visible)]="displayDialog" [modal]="true" [style]="{width: '300px'}">
    <p>Selected Date: {{ selectedDate }}</p>

    <form [formGroup]="eventForm" (ngSubmit)="addEvents()">
        <div class="p-field">
            <label for="eventTitle">Event Title</label>
            <textarea id="eventTitle" formControlName="title" pInputTextarea rows="2"></textarea>
        </div>

        <button type="submit" pButton label="Add Event"></button>
        <button type="button" (click)="closeDialog()" pButton label="Close" class="p-button-secondary"></button>
    </form>
</p-dialog>

<p-dialog header="Events on Selected Date" [(visible)]="displayEventListDialog" [modal]="true"
    [style]="{width: '500px'}">
    <p>Events on {{ Eventdateid }}</p>

    <div *ngIf="datewiseEventList.length > 0" class="event-list">
        <ul>
            <li *ngFor="let event of datewiseEventList" class="event-item">
                <p>{{ event.event }}</p>
            </li>
        </ul>
    </div>

    <button type="button" (click)="openAddEventDialog()" pButton label="Add More Events"
        class="p-button-primary"></button>
    <button type="button" (click)="closeEventListDialog()" pButton label="Close" class="p-button-secondary"></button>
</p-dialog>






<div *ngIf="Loader" class="spinner-container">
    <div class="spinner"></div>
</div>