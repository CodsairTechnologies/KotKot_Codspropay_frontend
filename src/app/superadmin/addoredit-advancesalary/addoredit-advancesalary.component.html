<div class="main">
  <div class="row  first-row">
    <!-- breadcrumbs -->
    <div class="col">
      <div class="breadcrumb">
        <span class="home-icon"><i class="bi bi-house-door-fill"></i></span>
        <a href="/superadmin/dashboard" class="breadcrumb-item">Dashboard</a> &nbsp; <i class="bi bi-chevron-right"></i>
        &nbsp;
        <a href="/superadmin/advancesalary" class="breadcrumb-item">Advance Salary</a> &nbsp; <i
          class="bi bi-chevron-right"></i> &nbsp;
        <a class="breadcrumb-item"> {{ isEditMode ? 'Edit Advance Salary' : 'Add
          Advance Salary' }}</a>

      </div>
    </div>
    <!-- breadcrumbs -->

  </div>



  <form [formGroup]="advanceSalaryForm">
    <div class="mt-3">
      <div class="box">
        <div class="mb-3 filter-body">
          <div class="row">
            <div class="col-lg-8 col-12">
              <label for="" class="title">Employee Salary details</label>
              <div class="emp-box">
                <div class="row mb-3">

                  <div class="col-md-6 col-12">
                    <div class="date">
                      <label for="PaidDate" class="form-label">Paid Date</label>
                      <input type="date" class="form-control" id="PaidDate" formControlName="PaidDate"
                        (change)="setDate()" placeholder="Enter advance amount Paid date">
                    </div>
                    <!-- error message -->
                    <div class="error-msg"
                      *ngIf="advanceSalaryForm.get('PaidDate')?.errors && advanceSalaryForm.get('PaidDate')?.touched">
                      <p>Paid Date is required!</p>
                    </div>
                  </div>

                  <div class="col-md-6 col-12">
                    <div class="empname">
                      <label for="Name" class="form-label">Employee Name <span class="required">*</span></label>
                      <div class="searchable-dropdown" #dropdownContainer>
                        <div class="dropdown-input">
                          <input type="text" placeholder="Select Employee" formControlName="Name"
                            (input)="filterEmployees($event)" (click)="toggleDropdown($event)"
                            [value]="selectedEmployee?.employeename || ''" (input)="onInputChange($event)">
                          <span class="dropdown-icon" (click)="toggleDropdown($event)"><i
                              class="bi bi-chevron-down"></i></span>
                          <span *ngIf="showCloseIcon" class="close-icon" (click)="clearSelection()"><i
                              class="bi bi-x fs-5"></i></span>
                        </div>
                        <ul *ngIf="showDropdown">
                          <li *ngIf="filteredEmployees.length === 0" class="no-data">No data found</li>
                          <li *ngFor="let employee of filteredEmployees" (click)="selectEmployee(employee)">
                            {{ employee.employeename }}
                          </li>
                        </ul>
                      </div>
                      <div class="error-msg"
                        *ngIf="advanceSalaryForm.get('Name')?.errors && advanceSalaryForm.get('Name')?.touched">
                        <p>Employee Name is required!</p>
                      </div>
                    </div>
                  </div>

                </div>

                <div class="row mb-3">
                  <div class="col-md-6 col-12">
                    <div class="date">
                      <label for="AdAmount" class="form-label">Advance Amount</label>
                      <input type="text" class="form-control" id="AdAmount" formControlName="AdAmount"
                        placeholder="Enter Advance Amount">
                    </div>
                    <!-- error message -->
                    <div class="error-msg"
                      *ngIf="advanceSalaryForm.get('AdAmount')?.errors && advanceSalaryForm.get('AdAmount')?.touched">
                      <p>Amount is required!</p>
                    </div>
                  </div>

                  <div class="col-md-6 col-12">
                    <div class="date">
                      <label for="Month" class="form-label">Salary Month</label>
                      <input type="month" class="form-control" id="Month" formControlName="Month"
                        placeholder="Enter Month and Year">
                    </div>
                    <!-- error message -->
                    <div class="error-msg"
                      *ngIf="advanceSalaryForm.get('Month')?.errors && advanceSalaryForm.get('Month')?.touched">
                      <p>Salary Month is required!</p>
                    </div>
                  </div>

                </div>


                <div class="row mb-3">
                  <div class="col-md-6 col-12">
                    <div class="">
                      <label for="EmpId" class="form-label">Employee ID</label>
                      <input type="text" class="form-control" id="EmpId" formControlName="EmpId" readonly>
                    </div>
                  </div>
                  <div class="col-md-6 col-12">
                    <div class="">
                      <label for="Salary" class="form-label">Salary</label>
                      <input type="text" class="form-control" id="Salary" formControlName="Salary" readonly>
                    </div>
                  </div>
                </div>

                <div class="row mb-3">
                  <div class="col-md-6 col-12">
                    <div class="">
                      <label for="Department" class="form-label">Department</label>
                      <input type="text" class="form-control" id="Department" formControlName="Department" readonly>
                    </div>
                  </div>
                  <!-- <div class="col-md-6 col-12">
                    <div class="mb-3 f1">
                      <label for="Unit" class="form-label">Unit</label>
                      <input type="text" class="form-control" id="Unit" formControlName="Unit" readonly>
                    </div>
                  </div> -->
                </div>


                <div class="row">
                  <div class="col-md-4 col-12 mb-3">
                    <label for="Loan" class="form-label">Loan</label>
                    <input type="text" class="form-control" id="Loan" formControlName="Loan" readonly>
                  </div>
                  <div class="col-md-4 col-12 mb-3" *ngIf="isLoan === 'Yes'">
                    <label for="LoanAmount" class="form-label">Loan Amount</label>
                    <input type="text" class="form-control" id="LoanAmount" formControlName="LoanAmount" readonly>
                  </div>
                  <div class="col-md-4 col-12 mb-3" *ngIf="isLoan === 'Yes'">
                    <label for="Emi" class="form-label">EMI</label>
                    <input type="text" class="form-control" id="Emi" formControlName="Emi" readonly>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-4 col-12" *ngIf="isLoan === 'Yes'">
                    <label for="balanceEmi" class="form-label">Balance EMI</label>
                    <input type="text" class="form-control" id="balanceEmi" formControlName="balanceEmi" readonly>
                  </div>
                  <div class="col-md-4 col-12" *ngIf="isLoan === 'Yes'">
                    <label for="balanceamount" class="form-label">Balance Amount</label>
                    <input type="text" class="form-control" id="balanceamount" formControlName="balanceamount" readonly>
                  </div>
                </div>

                <div class="row text-end ">
                  <div class="col ">
                    <button class="bttn" (click)="addAdSalary()"> Save</button>
                  </div>
                </div>

              </div>
            </div>

            <div class="col-lg-4 col-12">
              <label for="" class="title">Previous History</label>
              <div class="table-box">
                <div class="row m-1">
                  <div class="table-responsive">
                    <table class="table table-striped">
                      <thead>
                        <tr>
                          <th>EMP ID</th>
                          <th>Salary</th>
                          <th>Advance Amount</th>
                          <th>Date</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of historyList">
                          <td>{{ item.employeeid }}</td>
                          <td>{{ item.salary }}</td>
                          <td>{{ item.advanceamount }}</td>
                          <td>{{ item.date }}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>




<div *ngIf="Loader" class="spinner-container">
  <div class="spinner"></div>
</div>